/*jslint unparam: true, browser: true, indent: 2 */(function(e,t,n,r){"use strict";Foundation.libs.section={name:"section",version:"4.1.2",settings:{deep_linking:!1,one_up:!0,callback:function(){}},init:function(e,t,n){var r=this;Foundation.inherit(this,"throttle data_options position_right offset_right");if(typeof t!="string"){this.set_active_from_hash();this.events();return!0}return this[t].call(this,n)},events:function(){var r=this;e(this.scope).on("click.fndtn.section","[data-section] .title, [data-section] [data-section-title]",function(t){var n=e(this),i=n.closest("[data-section]");r.toggle_active.call(this,t,r)});e(t).on("resize.fndtn.section",r.throttle(function(){r.resize.call(this)},30)).on("hashchange",function(){if(!r.settings.toggled){r.set_active_from_hash();e(this).trigger("resize")}}).trigger("resize");e(n).on("click.fndtn.section",function(t){e(t.target).closest(".title, [data-section-title]").length<1&&e('[data-section="vertical-nav"], [data-section="horizontal-nav"]').find("section, .section, [data-section-region]").removeClass("active").attr("style","")})},toggle_active:function(t,n){var r=e(this),i=r.closest("section, .section, [data-section-region]"),s=i.find(".content, [data-section-content]"),o=i.closest("[data-section]"),n=Foundation.libs.section,u=e.extend({},n.settings,n.data_options(o));n.settings.toggled=!0;!u.deep_linking&&s.length>0&&t.preventDefault();if(i.hasClass("active"))(n.small(o)||n.is_vertical_nav(o)||n.is_horizontal_nav(o)||n.is_accordion(o))&&i.removeClass("active").attr("style","");else{var a=null,f=n.outerHeight(i.find(".title, [data-section-title]"));if(n.small(o)||u.one_up){a=r.closest("[data-section]").find("section.active, .section.active, .active[data-section-region]");n.small(o)?a.attr("style",""):a.attr("style","visibility: hidden; padding-top: "+f+"px;")}n.small(o)?i.attr("style",""):i.css("padding-top",f);i.addClass("active");a!==null&&a.removeClass("active").attr("style","");if(n.is_vertical_tabs(o)){s.css("display","block");a!==null&&a.find(".content").css("display","none")}}setTimeout(function(){n.settings.toggled=!1},300);u.callback()},resize:function(){var t=e("[data-section]"),n=Foundation.libs.section;t.each(function(){var t=e(this),r=t.find("section.active, .section.active, .active[data-section-region]"),i=e.extend({},n.settings,n.data_options(t));if(r.length>1)r.not(":first").removeClass("active").attr("style","");else if(r.length<1&&!n.is_vertical_nav(t)&&!n.is_horizontal_nav(t)&&!n.is_accordion(t)){var s=t.find("section, .section, [data-section-region]").first();i.one_up&&s.addClass("active");n.small(t)?s.attr("style",""):s.css("padding-top",n.outerHeight(s.find(".title, [data-section-title]")))}n.small(t)?r.attr("style",""):r.css("padding-top",n.outerHeight(r.find(".title, [data-section-title]")));n.position_titles(t);n.is_horizontal_nav(t)&&!n.small(t)||n.is_vertical_tabs(t)?n.position_content(t):n.position_content(t,!1)})},is_vertical_nav:function(e){return/vertical-nav/i.test(e.data("section"))},is_horizontal_nav:function(e){return/horizontal-nav/i.test(e.data("section"))},is_accordion:function(e){return/accordion/i.test(e.data("section"))},is_horizontal_tabs:function(e){return/^tabs$/i.test(e.data("section"))},is_vertical_tabs:function(e){return/vertical-tabs/i.test(e.data("section"))},set_active_from_hash:function(){var n=t.location.hash.substring(1),r=e("[data-section]"),i=this;r.each(function(){var t=e(this),r=e.extend({},i.settings,i.data_options(t));if(n.length>0&&r.deep_linking){t.find("section, .section, [data-section-region]").attr("style","").removeClass("active");t.find('.content[data-slug="'+n+'"], [data-section-content][data-slug="'+n+'"]').closest("section, .section, [data-section-region]").addClass("active")}})},position_titles:function(t,n){var r=t.find(".title, [data-section-title]"),i=0,s=0,o=this;typeof n=="boolean"?r.attr("style",""):r.each(function(){if(o.is_vertical_tabs(t)){e(this).css("top",s);s+=o.outerHeight(e(this))}else{o.rtl?e(this).css("right",i):e(this).css("left",i);i+=o.outerWidth(e(this))}})},position_content:function(t,n){var r=t.find(".title, [data-section-title]"),i=t.find(".content, [data-section-content]"),s=this;if(typeof n=="boolean"){i.attr("style","");t.attr("style","")}else if(s.is_vertical_tabs(t)&&!s.small(t)){var o=0,u=Number.MAX_VALUE,a=null;t.find("section, .section, [data-section-region]").each(function(){var n=e(this).find(".title, [data-section-title]"),r=e(this).find(".content, [data-section-content]"),i=0;a=s.outerWidth(n);i=s.outerWidth(t)-a;i<u&&(u=i);o+=s.outerHeight(n);e(this).hasClass("active")||r.css("display","none")});t.find("section, .section, [data-section-region]").each(function(){var t=e(this).find(".content, [data-section-content]");t.css("minHeight",o);t.css("maxWidth",u-2)});t.css("maxWidth",a+u)}else{t.find("section, .section, [data-section-region]").each(function(){var t=e(this).find(".title, [data-section-title]"),n=e(this).find(".content, [data-section-content]");s.rtl?n.css({right:s.position_right(t)+1,top:s.outerHeight(t)-2}):n.css({left:t.position().left-1,top:s.outerHeight(t)-2})});typeof Zepto=="function"?t.height(this.outerHeight(r.first())):t.height(this.outerHeight(r.first())-2)}},position_right:function(e){var t=e.closest("[data-section]"),n=e.closest("[data-section]").width(),r=t.find(".title, [data-section-title]").length;return n-e.position().left-e.width()*(e.index()+1)-r},reflow:function(){e("[data-section]").trigger("resize")},small:function(t){var n=e.extend({},this.settings,this.data_options(t));return this.is_horizontal_tabs(t)?!1:t&&this.is_accordion(t)?!0:e("html").hasClass("lt-ie9")?!0:e("html").hasClass("ie8compat")?!0:e(this.scope).width()<768},off:function(){e(this.scope).off(".fndtn.section");e(t).off(".fndtn.section");e(n).off(".fndtn.section")}}})(Foundation.zj,this,this.document);